# Security Operations and Monitoring
---
## 3.1 Given a scenario, analyze data as part of security monitoring activities.

sort data.txt | uniq -- sort the given file and then print only the unique values

With threat hunting, searching for a malicious process, organizations need to be able to filter out the legitimate activity—known-good behavior—generated by normal operation.

One source of security information is the event log from each network server or client. Systems such as Microsoft Windows, or Linux keep a variety of logs to record events as users and software interact with the system.

With threat hunting, anomalous behavior is that which falls out of the normal systems operation and could identify a process as suspicious.

For non-Windows hosts, events are managed by syslog. A syslog message comprises a PRI code, a header containing a timestamp and host name, and a message part. The PRI code is calculated from the facility and a severity level.

To avoid using hard-coded IP ranges, malware has switched to domains that are dynamically generated using an algorithm, usually referred to as a domain generation algorithm (DGA).

Reverse engineering is the process of analyzing a system's or application's structure to reveal more about how it functions. Some malware is easier to deconstruct than others.

An exploit technique describes the specific method by which malware code infects a target host. This may include services and properties of systems.

A malicious payload is a type of code implemented within an email message body. There are two main types of malicious payloads: exploits and attachments.

A web application firewall (WAF) is an application-layer security control that can apply a set of rules to HTTP traffic.

Cisco router trap levels:
- Emergency: 0
- Alert: 1
- Critical: 2
- Error: 3
- Warning: 4
- Notice: 5
- Informational: 6
- Debug: 7

Types of analysis:
- Heuristic analysis determines the susceptibility of a system towards a particular threat or risk using decision rules or weighing methods (IDS, IPS, and antivirus)
- Availability analysis is used to calculate the relative availability of a device or network
- Anomaly analysis focuses on identifying something that is unusual or abnormal.
- Trend analysis focuses on the long term direction in the increase or decrease in a particular type of traffic.

Informational events with ID 1102 show if the audit log has been cleared.

## 3.2 Given a scenario, implement configuration changes to existing controls to improve security.

An IDS appliance or software can usually be configured as an intrusion prevention system (IPS). An IPS blocks unknown traffic such as intrusion attempts and malicious activity.

Data loss prevention (DLP) products automate the discovery and classification of data types and enforce rules so that data is not viewed or transferred without a proper authorization.

Endpoint detection and response (EDR) is focused on logging of endpoint observables and indicators combined with behavioral- and anomaly-based analysis.

Network access control (NAC) provides the means to authenticate users and evaluate device integrity before a network connection is permitted.

DLP Policies
Tombstone - replace the original file with a policy violation
Quarantine - encrypt or move the file
Block - user retains access to but can't move the file
Alert - allows the action but records the incident


## 3.3 Explain the importance of proactive threat hunting.

In threat hunting, integrated intelligence correlates external threat intelligence with security intelligence drawn from internal logs and other sources.

The attack vector is a specific means of exploiting some point on the attack surface. The MITRE organization identifies three principal categories of attack vectors: cyber, human, physical.

If threat hunting shows that any assets have been put at risk, additional layers of security controls can be implemented around asset bundles to improve monitoring and prevention capabilities.

If threat hunting shows that any assets have been put at risk, additional layers of security controls can be implemented around asset bundles to improve monitoring and prevention capabilities.

Profiling threat actors and activities promotes the creation of scenarios that show how a prospective attacker might attempt an intrusion and what their objectives might be in terms of compromising system integrity or availability or exfiltrating confidential data.

Threat hunting improves detection capabilities.

In the case of SOAR, the task is principally incident response. An incident response workflow is usually defined as a playbook. A playbook is a checklist of actions to perform to detect and respond to a specific type of incident.


## 3.4 Compare and contrast automation concepts and technologies.

SCAP - Security Content Automation Protocol
- Created by NIST
- Creates a consistent language and format for discussing security issues
- Share descriptions of environments, remediations, and vulnerabilities

SCAP Components
- CVSS - Common Vulnerability Scoring System
- CCE - Common Configuration Enumeration: Standardizes system configuration
- CPE - Common Platform Enumeration: Standardizes product names and versions
- CVE - Common Vulnerabilities and Exposures: Standardizes vulnerabilities in those products
- XCCDF - Extensible Configuration Checklist Description Format: Standardizes checklists and results
- OVAL - Open Vulnerability and Assessment Language: Standardizes testing procedures

CVSS 3
- Scores vulnerabilities on a 10-point scale
`AV:[P,L,A,N]/AC:[H,L]/PR:[H,L,N]/UI:[R,N]/
`C:[N,L,H]/I:[N,L,H]/A:[N,L,H]/
`S:[C,U]`
Example:
`CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N`
- Exploitability Metrics: AV, AC, PR, UI
	- AV - Attack Vector
		- P - physical; must be able to touch or manipulate
		- L - local; console access or physical access required
		- A - adjacent network; local network access required
		- N - network; remotely exploitable vulnerability
	- AC - Attack Complexity
		- H - high; requires specialized conditions
		- L - low; does not require specialized conditions
	- PR - Privileges Required
		- H - high; requires admin control
		- L - low; requires basic user
		- N - none; requires no prior privileges
	- UI - User Interaction
		- R - required; user must take action
		- N - none; no user action required
- Impact Metrics: C, I, A
	- C - confidentiality
		- N - none; no impact
		- L - low; some impact
		- H - high; total impact
	- I - integrity
		- N - none; no impact
		- L - low; some impact
		- H - high; total impact
	- A - availability
		- N - none; no impact
		- L - low; some impact
		- H - high; total impact
- Scope: S
	- C - changed; can affect other components
	- U - unchanged; only affects resources managed by the same security authority

CVSS Scores
- 0 None
- 0.1-3.9 Low
- 4.0-6.9 Medium
- 7.0-8.9 High
- 9.0-10.0 Critical

CVSS 2
Base Metrics 
`AV:[L,A,N]/AC:[H,M,L]/Au:[M,S,N]/C:[N,P,C]/I:[N,P,C]/A:[N,P,C]
- Access Vector (AV)
	- L: Local access to the system (physical or virtual)
	- A: Adjacent network access (LAN)
	- N: Network access, available via remote connection
- Access Complexity (AC)
	- H: High Specialized access conditions (elevated priv or control of adjacent systems)
	- M: Medium Some specialized access conditions
	- L: Low No specialized access conditions
- Authentication (AU)
	- M: Multiple, must authenticate two or more times
	- S: Single, logged in once
	- N: None, no authentication
- Confidentiality Impact (C)
	- N: None, no impact
	- P: Partial, some impact
	- C: Complete, total impact
- Integrity Impact (I)
	- N: None
	- P: Partial
	- C: Complete
- Availability Impact (A)
	- N: None
	- P: Partial
	- C: Complete

Temporal Metrics 
`E:[U,POC,F,H,ND]/RL:[OF,TF,W,U,ND]/RC:[UC,UR,C,ND]
- Exploitability (E)
- Remediation Level (RL)
- Report Confidence (RC)

Environmental Metrics 
`CDP:[N,L,LM,MH,H,ND]/
`TD:[N,L,M,H,ND]/
`CR:[L,M,H,ND]/
`IR:[L,M,H,ND]/
`AR:[L,M,H,ND]
- Collateral Damage Potential (CDP)
- Target Distribution (TD)
- Confidentiality requirement (CR)
- Integrity requirement (IR)
- Availability requirement (AR)