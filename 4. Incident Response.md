# Incident Response
---
## 4.1 Explain the importance of the incident response process.

Defining security incidents:
- Security event - any activity that takes place on a system, network, or application that may have security implications
- Adverse security events - a security event with negative consequences
- Security incident - an adverse security event that violates security policy

Incident response plan elements
- Statement of purpose
- Strategies and goals for incident response
- Approach to incident response
- Communication with other groups
- Consult NIST SP 800-61 as you develop your plan

Incident response team
- Must be available 24/7
- Primary and backup personnel needed
- Management
- Infosec
- SME (devs, sa, dba)
- Legal
- Public affairs/Marketing
- HR
- Physical security
- IR service providers

Incident identification
- monitoring is crucial
- incident data sources
	- ids and ips
	- fw
	- authentication systems
	- integrity monitors
	- vuln scanners
	- system event logs
	- netflow records
	- anti-malware packages
- SIEM - security solution that collects information from diverse sources, analyzes it for signs of security incidents, and retains it for later use.

Communication plan
- Limit communication to trusted parties
- Involving law enforcement requires careful consideration
	- Legal obligation
	- Threat to safety
	- Legal team should provide guidance
	- Compy with regulatory notification requirements
- Have secure communications channels in place to prevent inadvertant leaks

Response coordination with relevant entities
- first responders should isolate the system to contain the damage
- quarantine but leave running to continue analysis while block communication to other devices

Escalation and notification
- Evalute incident severity based upon impact
- Escalate response to an appropriate level
- Notify management and other stakeholders

Triaging incidents
- low
	- minimal potential to affect security
	- handled by first responders
	- don't require after-hours response
- moderate
	- significant potential to affect security
	- trigger incident response team activation
	- notfiy management
- high
	- critical damage to information or systems
	- immediate full response
	- immediate notification to senior management
	- entire IR team is mobilized


## 4.2 Given a scenario, apply the appropriate incident response procedure.
Preparation
- Create an incident response team
- Backup devices
- Create incident response toolkit

Detection and analysis
Security event indicators
- Alerts
- Logs
- Public info
- People

Containment strategy evaluation
1. damage potential
2. evidence preservation
3. service availability
4. resource requirements
5. expected effectiveness
6. solution timeframe

Containment steps
- segmentation - network security technique; create a vlan and move impacted systems, then setup access controls to block communication
- isolation - compromised systems are moved to a completely different network separated from the rest of the network; the impacted system is still connected to the Internet
- removal - the compromised system is disconnected from any network; attacker is cutoff

Eradication and recovery
- Remove all traces of an incident
- Restore normal operations
- Correct the issues that led to the incident in the first place
- Sanitization and secure disposal
	- Clearing - overwrites sensitive information
	- Purging - more advanced clearing
	- Destruction - destroy the media; unable to reuse

Validation
- Verify the secure configuration of every system
- Run vulnerability scans
- Perform account and permissions review

Post-incident activities
- Lessons learned review
	- provides incident responders with an opportunity to reflect on the incident response efforts and offer feedback that will improve the organization's response to future incidents
	- use a trained facilitator to guide the conversation
	- time is of the essence to retain important details
	- What happened at what times?
	- Were documented procedures followed?
	- Were those procedures adequate?
	- Did any actions inhibit the recovery effort?
	- What would be done differently?
- Incident summary report - describes response efforts
- Evidence retention to comply with company and legal requirements


## 4.3 Given an incident, analyze potential indicators of compromise.
Network
- perform automated and manual reviews of network data sources
- bandwidth consumption - netflow records
- Irregular peer-to-peer traffic (lateral traffic)
- Beaconing - sending messages back to the command and control traffic
- Scanning - compromised system performing a network sweep
- Rogue devices - unapproved devices or access points on the network
- Evil Twin - fake access point and SSID that tricks users, can be automated with Karma toolkit

Host
- Antivirus alerts and warnings
- CPU utilization
- Individual processes with abnormally high usage
- Memory usage, overall and individual application use
- Disk usage, trends that drive capacity usage
- Unauthorized software
- Malicious processes
- Unauthorized changes (use tripwire)
- Unauthorized privileges
- Unauthorized scheduled tasks

Application
- Unusual application activity on the network
- Unexpected output
- Service interruptions


## 4.4 Given a scenario, utilize basic digital forensics techniques.
Investigation types
- administrative
	- internal to an org
	- seek to resolve technology issues
	- restore normal operations as quickly as possible
	- involve root cause analysis
	- HR issues
	- low standards of evidence
- criminal
	- look into possible crimes
	- involve fines and jail time
	- highest standard of evidence: beyond a reasonable doubt
- civil
	- disputes between parties
	- IP infringement
	- preponderance of the evidence standard
- regulatory
	- conducted by government
	- can be civil or criminal
	- can be used to enforce industry standards (such as PCI-DSS)
	- interviews are used by investigators
	- interviews are always voluntary, interrogations are mandatory (leave it to law enforcement)

Evidence types
- Real evidence - tangible objects
- Documentary evidence - written information
	- authentication rule - must be authenticated by testimony (Is this your signature?)
	- best evidence rule - original documents are superior to copies
- Parol evidence rule
	- written contracts are assumed to be the entire agreement
- Testimonial evidence - witness takes a stand
	- Direct evidence - based upon their observations
	- Expert opinion - draw conclusions based upon other evidence

Digital forensics
- investigative techniques that collect, preserve, analyze, and interpret digital evidence
- Investigations must never alter evidence

Volatility - the relative permanence of a piece of evidence; evidence that may not last long is more volatile than more permanent sources of evidence

Order of volatility
1. network traffic
2. memory contents
3. system and process data
4. files
5. logs
6. archived records

Time helps correlate records from different sources.

Write blockers - forensic disk controllers; prevent accidental modification of disks during imaging.

Hashes protect evidence by providing a unique file signature

File carving
- retrieve "deleted data from unallocated space"
- bulk extractor - tool for file carving
	- Ex. `bulk_extractor -o data_file -S jpeg_carve_mode=2 ./disk-image.dd`

dd utility can be used to create a disk image
Ex `sudo dd if=/dev/sdf of=myimage.img status=progress`
Next compute a hash of the image
`md5sum myimage.img` (this takes a while)

FTK imager - graphical utility for windows to create images

Digital forensic toolkit
- forensic workstation (high ram, storage, and cpu)
- forensic analysis suite (FTK, encase, helix)
- cryptographic tools (md5sum, shasum, etc)
- log viewers
- Documentation
	- incident response plan
	- chain of custody forms
	- incident forms
	- call list/escalation list
- office supplies
- cameras
- crime tape
- evidence bags
- tamper-proof seals

Live analysis
- retrieves volatile evidence
- memory dump to write current contents of ram (ftk imager can do this)
- sysinternals - suite of windows utilities
	- accessenum - view file permissions
	- autoruns - shows programs that run at system start
	- process explorer - deep view of processes
	- tcpview - shows active network connections

Password attack types
- brute force
- dictionary attack
- hybrid attacks
- rainbow table attacks