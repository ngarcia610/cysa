# Incident Response
---
## 4.1 Explain the importance of the incident response process.

Regulatory organizations may require notification of an incident, especially in companies like a hospital that must adhere to the Health Insurance Portability and Accountability Act (HIPAA) regulations.

Senior leadership will consider how the incident affects their departments or functional areas and will have to make decisions that affect the company directly.

Human resources (HR) is involved when an incident involves employee contracts or employment law. HR is also suitable to handle suspected insider threats.

Law enforcement authorities can provide services to assist in incident handling efforts such as initiating an investigation into the company to discover whether culpability for the breach should result in criminal charges.

Intellectual Property (IP) is information created by a company, typically about the products or services that they make or perform such as copyright work, patents, and trademarks. The current and new patents are the most critical to protect to ensure the company's success.

Special Protected Information (SPI) is non-identifying information, but privacy-sensitive information about a subject such as religious beliefs and political opinions.

Corporate information includes data such as profit, cash flow, salaries, market share, key customers, and so on, which are of interest to a company's competitors.

Financial information refers to data held about bank and investment accounts, plus information such as payroll and tax returns. Payment information like customers’ credit card numbers are labeled as financial information.

High Value Asset (HVA) is a critical information system. Critical means that if the confidentiality, integrity, or availability of the asset is compromised, it impacts mission essential functions of the organization.


## 4.2 Given a scenario, apply the appropriate incident response procedure.

Data correlation takes place in the detection and analysis phase. It uses cyber threat intelligence (CTI) to link indicators that will identify adversary capabilities.

Economics takes place in the detection and analysis phase. Both short- and long-term financial effects are taken into consideration when going through the incident response.

Vulnerability mitigation takes place in the eradication and recovery phase. If an open firewall port was discovered, the vulnerability can be eradicated by closing the port.

Secure disposal takes place in the eradication and recovery phase. It means physical destruction by mechanical shredding or incineration.

The change control process is the organization's way of performing corrective actions and remediating controls in a planned way. It will validate the compatibility and functionality of the new security patch for all other systems and will commonly complete patches within a week.

Incidents are NOT prioritized in the order in which they were detected and reported.

The factors contributing to incident severity and prioritization include:
- Scope of impact
	- Downtime - amount of time the resource was unavailable
	- Recovery time - amount of time taken to recover
	- Data integrity - amount of data corrupted or altered
	- Economic - cost of the incident to the organization
	- System process criticality - criticality of the systems involved
- Types of data at risk
	- Certain types of data create more liability for the organization if compromised


## 4.3 Given an incident, analyze potential indicators of compromise.

Memory consumption is a host-related indicator. For example, a memory leak where a process claims more and more memory without releasing it again can be a sign of malware.

Data exfiltration is a host-related indicator where data is collected from multiple servers and stored on one or more other assets compromised by an attacker.

Beaconing is a network-related indicator. It is the process by which a Command and Control (C2) server (like one used in a botnet) pings other bots to verify they are still alive.

Bandwidth consumption is a network-related indicator. It may indicate a worm-type malware infecting hosts and propagating over network links, choking intermediate systems such as switches and routers.

The standard Windows dir command can identify file system anomalies. For example, running dir /AH will only display hidden files and folders. Malicious files are commonly hidden in the operating system.

The lsof command used in Linux can quickly get a list of all resources a process is currently using, which can identify malicious processes using too many resources.

Excessive number of TIME_WAIT connections in a load balancer's or web server's state table is an indication that a distributed denial of service (DDoS) is occurring. Multiple external connections are in queue trying to connect in some way.

An “HTTP 503” is an application log that basically says service is unavailable. This also indicates a DDoS attack is occurring.

The correct name of the server or website is most likely used in this case, so that external clients can find the correct server.

A server's increase in memory usage indicates an issue or security breach on the server rather than from the network. Malware may be processing large of amounts of data of some sort.

Use tasklist cmd to view memory consumption by process on Windows.

## 4.4 Given a scenario, utilize basic digital forensics techniques.

Pulling the power plug is a static acquisition process when capturing evidence. This is most likely to preserve the storage devices in a forensically clean state, but there is the risk of corrupting data.

Shutting down the computer from the operating system is another form of static acquisition. This risk malware activating anti-forensic processes to hides its existence.

Copying data is a live acquisition of evidence. This can reduce downtime; however, data may have changed during the copy and may not be acceptable as legal evidence.

Using a write blocker will require removing the hard drive from the computer. The clean state of the drive depends on whether the system was on or off while the drive was removed.

The basic syntax of the command is tcpdump -i eth, where 'eth' is the interface to listen for network traffic. eth can be replaced with 'any' to listen on all interfaces of a multihomed host.

Virtual disk image (VDI) is a storage file of a virtual machine running on the VirtualBox hypervisor platform. VirtualBox runs on an operating system like Windows just like Hyper-V.

Virtual hard drive (VHD) is a virtual storage running on a Windows Hyper-V platform. VHDs are mountable in Windows.

Virtual hard drive extended (VHDX) is used in a Hyper-V environment but provides increased storage capacity of up to 64 terabytes (TB).

Virtual machine disk (VMDK) is a storage file of a virtual machine that acts as, for example, the C: drive on a Windows server VM.

The universal forensic extraction device (UFED) is created by Cellebrite and is a physical device for use in the field to perform mobile forensic analysis. However, the software version can also be installed on a system like a laptop and have the same capabilities.

The Encase Portable software is a mobile forensic tool. Other notable vendors include Oxygen Forensics and Micro Systemation AB.

Mobile Phone Examiner Plus (MPE+) from AccessData is another available mobile forensic tool.

Virtual machine introspection (VMI) uses tools installed on the hypervisor of a physical server to retrieve pages of memory for analysis.

Network Miner is a network file carving tool that can reconstruct the correct byte order of network packets (in case they were transmitted out of sequence), strip the protocol information, and save the resulting data to a file.

Bro is an IDS for UNIX systems.
